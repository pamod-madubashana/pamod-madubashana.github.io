import{a as u,j as e}from"./ui-DPnNW4ni.js";import{C as b,a as E,b as v}from"./card-BMgi0ewS.js";import{c as B,r as l,s as g,A as p,t as T,o as k,m,L as F,B as I}from"./index-BNWbYMF_.js";import{B as f}from"./badge-CillsTHy.js";import{F as y,P as N}from"./package-ChBlTKpL.js";import{C as w}from"./clock-D_lSVke7.js";const L=[["path",{d:"M7 7h10v10",key:"1tivn9"}],["path",{d:"M7 17 17 7",key:"1vkiza"}]],G=B("arrow-up-right",L),H={getStats:async s=>{const i=g.dashboard.stats(s),c=l.get(i);if(c)return c;const a=await fetch(`${p}/dashboard/stats`,{headers:{Authorization:`Bearer ${s}`}});if(!a.ok){const d=await a.text();throw new Error(`Failed to fetch dashboard stats: ${a.status} - ${d}`)}const n=await a.json();return l.set(i,n,3e5),n},getAnalytics:async s=>{const i=g.dashboard.analytics(s),c=l.get(i);if(c)return c;const a=await fetch(`${p}/dashboard/analytics`,{headers:{Authorization:`Bearer ${s}`}});if(!a.ok){const d=await a.text();throw new Error(`Failed to fetch analytics: ${a.status} - ${d}`)}const n=await a.json();return l.set(i,n,3e5),n},getEnhancedDashboard:async(s,i=!1)=>{const c=g.dashboard.enhanced(s);if(!i){const d=l.get(c);if(d)return d}const a=await fetch(`${p}/dashboard/enhanced/dashboard`,{headers:{Authorization:`Bearer ${s}`}});if(!a.ok){const d=await a.text();throw new Error(`Failed to fetch enhanced dashboard data: ${a.status} - ${d}`)}const n=await a.json();return l.set(c,n,12e4),n},invalidateDashboardCache:()=>{l.invalidate("dashboard:*")}},_=()=>{const{token:s,user:i}=T(),[c,a]=u.useState(!0),[n,d]=u.useState(null),[o,$]=u.useState(null);u.useEffect(()=>{s?(async()=>{try{a(!0);const r=await H.getEnhancedDashboard(s);$(r)}catch(r){console.error("Error fetching dashboard data:",r),d(r instanceof Error?r.message:"Failed to load dashboard data")}finally{a(!1)}})():a(!1)},[s]);const D=()=>{const t=new Date().getHours();return t>=5&&t<12?"Good morning":t>=12&&t<17?"Good afternoon":t>=17&&t<21?"Good evening":"Good night"},C=o?[{title:"Total Articles",value:o.stats.articles.total.toString(),change:o.stats.articles.change,icon:y,color:"text-blue-400",bgColor:"bg-blue-500/10",trend:"up"},{title:"Active Projects",value:o.stats.projects.total.toString(),change:o.stats.projects.change,icon:N,color:"text-purple-400",bgColor:"bg-purple-500/10",trend:"up"},{title:"Timeline Items",value:o.stats.timeline.total.toString(),change:"+0",icon:k,color:"text-indigo-400",bgColor:"bg-indigo-500/10",trend:"up"},{title:"Tech Skills",value:o.stats.techSkills.total.toString(),change:"+0",icon:y,color:"text-green-400",bgColor:"bg-green-500/10",trend:"up"}]:[],A=t=>{switch(t){case"published":return e.jsx(f,{variant:"default",className:"bg-success/20 text-success border-success/30",children:"Published"});case"draft":return e.jsx(f,{variant:"secondary",className:"bg-warning/20 text-warning border-warning/30",children:"Draft"});default:return e.jsx(f,{variant:"secondary",children:t})}},S=t=>{const r=new Date(t),h=Math.floor((new Date().getTime()-r.getTime())/(1e3*60*60));if(h<1)return"Just now";if(h<24)return`${h} hour${h>1?"s":""} ago`;const x=Math.floor(h/24);return x<7?`${x} day${x>1?"s":""} ago`:r.toLocaleDateString("en-US",{month:"short",day:"numeric",year:x>365?"numeric":void 0})};return e.jsxs(e.Fragment,{children:[e.jsxs(m.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6},className:"grid grid-cols-1 md:grid-cols-3 gap-6 mb-8",children:[e.jsxs("div",{className:"md:col-span-2",children:[e.jsxs("h1",{className:"text-3xl md:text-4xl font-bold mb-2 text-foreground/60",children:[D(),", ",e.jsx("span",{className:"text-gradient",children:(i==null?void 0:i.username)||"Admin"})]}),e.jsx("p",{className:"text-muted-foreground text-lg",children:"Here's what's happening with your portfolio today."})]}),e.jsx("div",{className:"flex items-center justify-end",children:e.jsx("div",{className:"text-right",children:e.jsxs("div",{className:"flex items-center gap-2 text-sm text-muted-foreground mb-1",children:[e.jsx(w,{className:"w-4 h-4"}),e.jsx("span",{children:"Updated just now"})]})})})]}),e.jsx("div",{className:"space-y-6",children:c?e.jsx("div",{className:"flex justify-center items-center py-20",children:e.jsx(F,{className:"w-8 h-8 text-primary animate-spin"})}):n?e.jsxs("div",{className:"text-center py-20 text-destructive",children:["Error loading dashboard: ",n]}):o?e.jsx(m.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6,delay:.1},className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-6",children:C.map((t,r)=>{const j=t.icon;return e.jsx(m.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},transition:{duration:.5,delay:.1*r},whileHover:{y:-4},className:"group card-hover",children:e.jsxs(b,{className:"glass border border-border hover:border-primary/30 transition-all duration-300 h-full overflow-hidden relative",children:[e.jsx(E,{className:"relative pb-3",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("div",{className:`${t.bgColor} p-3 rounded-lg`,children:e.jsx(j,{className:`w-6 h-6 ${t.color}`})}),e.jsxs("div",{className:`flex items-center gap-1 text-sm font-medium ${t.trend==="up"?"text-success":"text-destructive"}`,children:[e.jsx(G,{className:`w-4 h-4 ${t.trend==="down"?"rotate-180":""}`}),t.change]})]})}),e.jsxs(v,{className:"relative pt-0",children:[e.jsx("p",{className:"text-3xl font-bold mb-1",children:t.value}),e.jsx("p",{className:"text-muted-foreground text-sm",children:t.title})]})]})},t.title)})}):e.jsx("div",{className:"text-center py-20 text-muted-foreground",children:"No dashboard data available"})}),e.jsx("div",{className:"mt-8 grid grid-cols-1 gap-6",children:e.jsx(m.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{duration:.6,delay:.2},className:"space-y-6",children:e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("h2",{className:"text-2xl font-bold flex items-center gap-3",children:[e.jsx(w,{className:"w-6 h-6 text-primary"}),e.jsx("span",{className:"text-foreground/60",children:"Recent Activity"})]}),e.jsx(I,{variant:"ghost",className:"text-primary hover:text-primary/80",children:"View All"})]}),e.jsx(b,{className:"glass border border-border h-full",children:e.jsx(v,{className:"p-0",children:e.jsx("div",{className:"divide-y divide-border",children:(o==null?void 0:o.recentActivity.map((t,r)=>e.jsx(m.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{duration:.4,delay:.1*r},className:"p-4 hover:bg-white/5 transition-colors",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:`p-2 rounded-lg ${t.type==="article"?"bg-primary/20 text-primary":"bg-secondary/20 text-secondary"}`,children:t.type==="article"?e.jsx(y,{className:"w-5 h-5"}):e.jsx(N,{className:"w-5 h-5"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-medium",children:t.title}),e.jsx("p",{className:"text-sm text-muted-foreground",children:S(t.date)}),e.jsxs("p",{className:"text-xs text-muted-foreground/70",children:["by ",t.author]})]})]}),A(t.status)]})},t.id)))||e.jsx("div",{className:"p-4 text-center text-muted-foreground",children:"No recent activity"})})})})]})})})]})};export{_ as default};
