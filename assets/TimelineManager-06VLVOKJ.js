import{a as n,j as e}from"./ui-DPnNW4ni.js";import{C,b as N,a as A,c as G,d as _}from"./card-CstHLFes.js";import{t as H,i as M,v as U,B as m,j as R,w as q,k as Y,I as u,G as J,P as K}from"./index-E5yFclhN.js";import{L as d}from"./label-C2nbGQ4U.js";import{t as x,B as I,T as Q}from"./timelineApi-vIhmTgEN.js";import{r as V,a as W,b as X}from"./orderUtils-CtTJ9iqJ.js";import{P as Z,S as $,T as ee,C as re}from"./ConfirmDialog-C69hcbGx.js";import{S as se}from"./save-CcyEnk7P.js";import{S as ae}from"./search-C90xBteo.js";import{C as te}from"./cloud-DGE3Lx7f.js";import{C as ie}from"./clock-ydXwfNbY.js";const fe=()=>{const{token:i}=H(),[l,T]=n.useState([]),[f,j]=n.useState([]),[g,D]=n.useState(""),[S,v]=n.useState(!0),[k,h]=n.useState(!1),[s,o]=n.useState(null),[t,c]=n.useState({year:"",role:"",company:"",description:"",icon:"Briefcase",order:0}),[y,b]=n.useState({isOpen:!1,id:"",type:""}),p=async(r=!1)=>{if(!i){v(!1);return}try{const a=await x.getAllTimeline(i,r);T(a)}catch(a){console.error("Error fetching timeline items:",a)}finally{v(!1)}};n.useEffect(()=>{p()},[i]),n.useEffect(()=>{if(!g)j(l);else{const r=g.toLowerCase();j(l.filter(a=>a.year.toLowerCase().includes(r)||a.role.toLowerCase().includes(r)||a.company.toLowerCase().includes(r)||a.description.toLowerCase().includes(r)))}},[g,l]);const E=async()=>{if(i)try{await W(l,t.order,"/timeline",i),await x.createTimeline(i,t),await p(!0),c({year:"",role:"",company:"",description:"",icon:"Briefcase",order:0}),h(!1)}catch(r){console.error("Error creating timeline item:",r)}},F=async()=>{if(!(!s||!i))try{await V(l,s._id,s.order,"/timeline",i),await x.updateTimeline(i,s._id,{year:s.year,role:s.role,company:s.company,description:s.description,icon:s.icon,order:s.order}),await p(!0),o(null)}catch(r){console.error("Error updating timeline item:",r)}},L=async r=>{if(i)try{const a=l.find(z=>z._id===r);if(!a)return;await X(l,a.order,"/timeline",i),await x.deleteTimeline(i,r),await p(!0)}catch(a){console.error("Error deleting timeline item:",a)}},O=(r,a)=>{b({isOpen:!0,id:r,type:a})},w=()=>{b({isOpen:!1,id:"",type:""})},B=()=>{L(y.id),w()},P=r=>{switch(r){case"Clock":return ie;case"Briefcase":return I;case"Terminal":return Q;case"Palette":return K;case"Cloud":return te;case"Github":return J;default:return I}};return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"min-h-screen from-gray-900 to-gray-800 p-4 md:p-8",children:e.jsxs("div",{className:"max-w-6xl mx-auto",children:[e.jsx("header",{className:"mb-8",children:e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between gap-4",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-white",children:"Timeline Manager"}),e.jsx("p",{className:"text-muted-foreground",children:"Manage your professional timeline"})]}),e.jsxs(M,{open:k,onOpenChange:h,children:[e.jsx(U,{asChild:!0,children:e.jsxs(m,{className:"flex items-center gap-2",children:[e.jsx(Z,{className:"w-4 h-4"}),"New Timeline Item"]})}),e.jsxs(R,{className:"max-w-3xl max-h-[90vh] overflow-y-auto bg-gray-900 text-white border border-gray-700",children:[e.jsx(q,{children:e.jsx(Y,{children:s?"Edit Timeline Item":"Create New Timeline Item"})}),e.jsxs("div",{className:"grid gap-4 py-4",children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsx(d,{htmlFor:"year",children:"Year"}),e.jsx(u,{id:"year",value:s?s.year:t.year,onChange:r=>s?o({...s,year:r.target.value}):c({...t,year:r.target.value}),placeholder:"e.g., 2024 - Present",className:"bg-gray-800 border-none text-white placeholder-gray-400 focus-visible:ring-0 focus-visible:ring-offset-0 resize-none"})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(d,{htmlFor:"role",children:"Role"}),e.jsx(u,{id:"role",value:s?s.role:t.role,onChange:r=>s?o({...s,role:r.target.value}):c({...t,role:r.target.value}),placeholder:"e.g., Software Engineer",className:"bg-gray-800 border-none text-white placeholder-gray-400 focus-visible:ring-0 focus-visible:ring-offset-0 resize-none"})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(d,{htmlFor:"company",children:"Company"}),e.jsx(u,{id:"company",value:s?s.company:t.company,onChange:r=>s?o({...s,company:r.target.value}):c({...t,company:r.target.value}),placeholder:"e.g., Acme Corp",className:"bg-gray-800 border-none text-white placeholder-gray-400 focus-visible:ring-0 focus-visible:ring-offset-0 resize-none"})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(d,{htmlFor:"description",children:"Description"}),e.jsx("textarea",{id:"description",value:s?s.description:t.description,onChange:r=>s?o({...s,description:r.target.value}):c({...t,description:r.target.value}),placeholder:"Describe your role and responsibilities",className:"min-h-[100px] w-full rounded-md border-none bg-gray-800 px-3 py-2 text-white placeholder-gray-400 focus:ring-0 focus:ring-offset-0 resize-none"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsx(d,{htmlFor:"icon",children:"Icon"}),e.jsxs("select",{id:"icon",value:s?s.icon:t.icon,onChange:r=>s?o({...s,icon:r.target.value}):c({...t,icon:r.target.value}),className:"w-full rounded-md border-none bg-gray-800 px-3 py-2 text-white focus:ring-0 focus:ring-offset-0",children:[e.jsx("option",{value:"Briefcase",children:"Briefcase"}),e.jsx("option",{value:"Clock",children:"Clock"}),e.jsx("option",{value:"Terminal",children:"Terminal"}),e.jsx("option",{value:"Palette",children:"Palette"}),e.jsx("option",{value:"Cloud",children:"Cloud"}),e.jsx("option",{value:"Github",children:"GitHub"})]})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(d,{htmlFor:"order",children:"Order"}),e.jsx(u,{id:"order",type:"number",value:s?s.order:t.order,onChange:r=>s?o({...s,order:parseInt(r.target.value)}):c({...t,order:parseInt(r.target.value)}),placeholder:"Order position",className:"bg-gray-800 border-none text-white placeholder-gray-400 focus-visible:ring-0 focus-visible:ring-offset-0 resize-none"})]})]}),e.jsxs("div",{className:"flex justify-end gap-2 pt-4",children:[e.jsx(m,{variant:"outline",onClick:()=>{h(!1),o(null)},className:"border-input text-foreground hover:bg-accent hover:text-accent-foreground",children:"Cancel"}),e.jsxs(m,{onClick:s?F:E,children:[e.jsx(se,{className:"w-4 h-4 mr-2"}),s?"Update":"Create"]})]})]})]})]})]})}),e.jsx("div",{className:"mb-6",children:e.jsxs("div",{className:"relative",children:[e.jsx(ae,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-muted-foreground w-4 h-4"}),e.jsx(u,{placeholder:"Search timeline items...",value:g,onChange:r=>D(r.target.value),className:"flex h-10 w-full rounded-md border border-input bg-white dark:bg-slate-800 text-gray-900 dark:text-white px-3 py-2 ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm pl-10"})]})}),S?e.jsx("div",{className:"text-center py-8",children:e.jsx("p",{className:"text-muted-foreground",children:"Loading timeline items..."})}):f.length===0?e.jsx(C,{className:"glass border border-primary/30",children:e.jsx(N,{className:"py-12 text-center",children:e.jsx("p",{className:"text-muted-foreground",children:"No timeline items found"})})}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:f.map(r=>{const a=P(r.icon);return e.jsxs(C,{className:"glass border border-primary/30 relative",children:[e.jsx("div",{className:"absolute -top-2 -left-2 bg-primary text-white rounded-full w-6 h-6 flex items-center justify-center text-xs font-bold z-10",children:r.order}),e.jsxs(A,{children:[e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{children:[e.jsxs(G,{className:"flex items-center gap-2",children:[e.jsx(a,{className:"w-5 h-5 text-primary"}),r.role]}),e.jsx(_,{className:"mt-1",children:r.company})]}),e.jsxs("div",{className:"flex gap-1",children:[e.jsx(m,{size:"sm",variant:"ghost",onClick:()=>{o(r),h(!0)},className:"h-8 w-8 p-0",children:e.jsx($,{className:"w-4 h-4"})}),e.jsx(m,{size:"sm",variant:"ghost",onClick:()=>O(r._id,"delete"),className:"h-8 w-8 p-0 text-red-500 hover:text-red-500",children:e.jsx(ee,{className:"w-4 h-4"})})]})]}),e.jsx("div",{className:"text-sm text-muted-foreground mt-2",children:r.year})]}),e.jsx(N,{children:e.jsx("p",{className:"text-sm",children:r.description})})]},r._id)})})]})}),e.jsx(re,{isOpen:y.isOpen,onClose:w,onConfirm:B,title:"Confirm Deletion",message:"Are you sure you want to delete this timeline item? This action cannot be undone.",confirmText:"Delete",cancelText:"Cancel",variant:"destructive"})]})};export{fe as default};
