{"version":3,"file":"orderUtils-BeE2xQdG.js","sources":["../../src/lib/orderUtils.ts"],"sourcesContent":["import { API_BASE_URL } from './apiConfig';\n\ninterface OrderableItem {\n  _id: string;\n  order: number;\n}\n\n/**\n * Reorders items when inserting a new item at a specific order position.\n * If the target order already exists, shifts existing items with order >= targetOrder up by 1.\n * \n * @param items - Current list of items\n * @param newItemOrder - Order position for the new item\n * @param endpoint - API endpoint for the specific resource (e.g., '/tech-skills')\n * @param token - Authentication token\n * @returns Promise<void>\n */\nexport const reorderItemsForInsertion = async (\n  items: OrderableItem[],\n  newItemOrder: number,\n  endpoint: string,\n  token: string\n): Promise<void> => {\n  // Filter items that need to be updated (order >= newItemOrder)\n  const itemsToUpdate = items.filter(item => item.order >= newItemOrder);\n  \n  // Sort items by order in descending order to avoid conflicts\n  // Process items with higher orders first\n  const sortedItems = itemsToUpdate.sort((a, b) => b.order - a.order);\n  \n  // Update items sequentially to push them down\n  for (const item of sortedItems) {\n    const response = await fetch(`${API_BASE_URL}${endpoint}/${item._id}`, {\n      method: 'PUT',\n      headers: {\n        'Content-Type': 'application/json',\n        'Authorization': `Bearer ${token}`\n      },\n      body: JSON.stringify({ ...item, order: item.order + 1 })\n    });\n    \n    if (!response.ok) {\n      console.error(`Failed to update order for item ${item._id}:`, await response.text());\n    }\n  }\n};\n\n/**\n * Reorders items when deleting an item.\n * Shifts items with order > deletedItemOrder down by 1 to fill the gap.\n * \n * @param items - Current list of items\n * @param deletedItemOrder - Order position of the deleted item\n * @param endpoint - API endpoint for the specific resource (e.g., '/tech-skills')\n * @param token - Authentication token\n * @returns Promise<void>\n */\nexport const reorderItemsForDeletion = async (\n  items: OrderableItem[],\n  deletedItemOrder: number,\n  endpoint: string,\n  token: string\n): Promise<void> => {\n  // Remove the deleted item and sort remaining items by their original order\n  const remainingItems = items.filter(item => item.order !== deletedItemOrder)\n    .sort((a, b) => a.order - b.order);\n  \n  // Reassign contiguous orders starting from 1\n  for (let i = 0; i < remainingItems.length; i++) {\n    const item = remainingItems[i];\n    const newOrder = i + 1;\n    \n    if (item.order !== newOrder) { // Only update if order actually changed\n      const response = await fetch(`${API_BASE_URL}${endpoint}/${item._id}`, {\n        method: 'PUT',\n        headers: {\n          'Content-Type': 'application/json',\n          'Authorization': `Bearer ${token}`\n        },\n        body: JSON.stringify({ ...item, order: newOrder })\n      });\n      \n      if (!response.ok) {\n        console.error(`Failed to update order for item ${item._id}:`, await response.text());\n      }\n    }\n  }\n};\n\n/**\n * Completely reorders all items to ensure contiguous ordering.\n * \n * @param items - Current list of items\n * @param endpoint - API endpoint for the specific resource (e.g., '/tech-skills')\n * @param token - Authentication token\n * @returns Promise<void>\n */\nexport const reorderAllItemsContiguously = async (\n  items: OrderableItem[],\n  endpoint: string,\n  token: string\n): Promise<void> => {\n  // Sort items by their current order\n  const sortedItems = [...items].sort((a, b) => a.order - b.order);\n  \n  // Reassign contiguous orders starting from 1\n  for (let i = 0; i < sortedItems.length; i++) {\n    const item = sortedItems[i];\n    const newOrder = i + 1;\n    \n    if (item.order !== newOrder) { // Only update if order actually changed\n      const response = await fetch(`${API_BASE_URL}${endpoint}/${item._id}`, {\n        method: 'PUT',\n        headers: {\n          'Content-Type': 'application/json',\n          'Authorization': `Bearer ${token}`\n        },\n        body: JSON.stringify({ ...item, order: newOrder })\n      });\n      \n      if (!response.ok) {\n        console.error(`Failed to update order for item ${item._id}:`, await response.text());\n      }\n    }\n  }\n};\n\n/**\n * Reorders items when updating an item's order position.\n * Adjusts other items to maintain proper sequence without gaps.\n * \n * @param items - Current list of items\n * @param itemId - ID of the item being updated\n * @param newOrder - New order position for the item\n * @param endpoint - API endpoint for the specific resource (e.g., '/tech-skills')\n * @param token - Authentication token\n * @returns Promise<void>\n */\nexport const reorderItemsForUpdate = async (\n  items: OrderableItem[],\n  itemId: string,\n  newOrder: number,\n  endpoint: string,\n  token: string\n): Promise<void> => {\n  const currentItem = items.find(item => item._id === itemId);\n  if (!currentItem) return;\n\n  const oldOrder = currentItem.order;\n  \n  if (newOrder === oldOrder) return; // No change needed\n\n  if (newOrder > oldOrder) {\n    // Moving down: shift items between oldOrder and newOrder down by 1\n    const itemsToShiftDown = items.filter(item => \n      item._id !== itemId && item.order > oldOrder && item.order <= newOrder\n    );\n    \n    // Sort in ascending order to process from highest to lowest\n    const sortedDown = itemsToShiftDown.sort((a, b) => b.order - a.order);\n    \n    for (const item of sortedDown) {\n      const response = await fetch(`${API_BASE_URL}${endpoint}/${item._id}`, {\n        method: 'PUT',\n        headers: {\n          'Content-Type': 'application/json',\n          'Authorization': `Bearer ${token}`\n        },\n        body: JSON.stringify({ ...item, order: item.order - 1 })\n      });\n      \n      if (!response.ok) {\n        console.error(`Failed to update order for item ${item._id}:`, await response.text());\n      }\n    }\n  } else {\n    // Moving up: shift items between newOrder and oldOrder up by 1\n    const itemsToShiftUp = items.filter(item => \n      item._id !== itemId && item.order >= newOrder && item.order < oldOrder\n    );\n    \n    // Sort in descending order to avoid conflicts\n    const sortedUp = itemsToShiftUp.sort((a, b) => b.order - a.order);\n    \n    for (const item of sortedUp) {\n      const response = await fetch(`${API_BASE_URL}${endpoint}/${item._id}`, {\n        method: 'PUT',\n        headers: {\n          'Content-Type': 'application/json',\n          'Authorization': `Bearer ${token}`\n        },\n        body: JSON.stringify({ ...item, order: item.order + 1 })\n      });\n      \n      if (!response.ok) {\n        console.error(`Failed to update order for item ${item._id}:`, await response.text());\n      }\n    }\n  }\n};"],"names":["reorderItemsForInsertion","items","newItemOrder","endpoint","token","sortedItems","item","a","b","response","API_BASE_URL","reorderItemsForDeletion","deletedItemOrder","remainingItems","i","newOrder","reorderItemsForUpdate","itemId","currentItem","oldOrder","sortedDown","sortedUp"],"mappings":"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"}