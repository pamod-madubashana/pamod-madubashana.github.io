import{a as c,j as e}from"./ui-DPnNW4ni.js";import{t as ae,i as q,v as ie,B as d,j as _,w as A,k as O,I as o,T as B,S as J,G as le,E as ne,p as b}from"./index-b3rgQIXD.js";import{C as R,b as M,a as oe,c as ce,d as de}from"./card-BACTo1MO.js";import{B as U}from"./badge-CjYwKUWv.js";import{L as n}from"./label-Ba8Hti8K.js";import{P as ge,S as ue,T as he,C as me}from"./ConfirmDialog-CW4CgZUk.js";import{S as H}from"./save-DOQvdMNn.js";import{S as pe}from"./search-D63gHbwG.js";const we=()=>{var G;const[p,x]=c.useState([]),[D,F]=c.useState([]),[v,W]=c.useState(""),[Y,$]=c.useState(!0),[K,y]=c.useState(!1),[r,g]=c.useState(null),[i,u]=c.useState({title:"",description:"",tags:"",languages:"",githubUrl:"",liveUrl:"",featured:!1,status:"draft",thumbnail:"",screenshots:""}),[j,N]=c.useState(null),[h,C]=c.useState(null),[k,T]=c.useState(!1),[E,z]=c.useState(!1),[Q,w]=c.useState(!1),[P,S]=c.useState(null),{token:m}=ae(),L=t=>{var a;const s=(a=t.target.files)==null?void 0:a[0];s&&N(s)},I=t=>{C(t.target.files)},V=async()=>{if(!m){console.error("Authentication token is missing"),alert("You must be logged in to create a project");return}if(!i.title.trim()){console.error("Error: Title is required"),alert("Title is required");return}if(!i.description.trim()){console.error("Error: Description is required"),alert("Description is required");return}const t=i.tags.split(",").map(s=>s.trim()).filter(s=>s);if(t.length===0){console.error("Error: At least one tag is required"),alert("At least one tag is required");return}T(!0);try{const s=new FormData;s.append("title",i.title),s.append("description",i.description),s.append("tags",JSON.stringify(t));const a=i.languages.split(",").map(l=>l.trim()).filter(l=>l);if(s.append("languages",JSON.stringify(a)),s.append("status",i.status),s.append("featured",i.featured.toString()),s.append("githubUrl",i.githubUrl.trim()),s.append("liveUrl",i.liveUrl.trim()),j&&s.append("thumbnail",j),h)for(let l=0;l<h.length;l++)s.append("screenshots",h[l]);console.log("Sending request to create project with data:",{title:i.title,description:i.description,tags:t,hasThumbnail:!!j,screenshotCount:(h==null?void 0:h.length)||0});const f=await b.createProjectWithImage(m,s);console.log("Project created successfully:",f),x([f.project,...p]),u({title:"",description:"",tags:"",languages:"",githubUrl:"",liveUrl:"",featured:!1,status:"draft",thumbnail:"",screenshots:""}),N(null),C(null),y(!1)}catch(s){console.error("Error creating project with image:",s),alert("Failed to create project: "+s.message)}finally{T(!1)}},X=async()=>{var t,s;if(!r||!m){m||(console.error("Authentication token is missing"),alert("You must be logged in to update a project"));return}if(!r.title.trim()){console.error("Error: Title is required"),alert("Title is required");return}if(!r.description.trim()){console.error("Error: Description is required"),alert("Description is required");return}if(r.tags.length===0){console.error("Error: At least one tag is required"),alert("At least one tag is required");return}z(!0);try{const a=new FormData;if(a.append("title",r.title),a.append("description",r.description),a.append("tags",JSON.stringify(r.tags)),a.append("languages",JSON.stringify(r.languages)),a.append("featured",r.featured.toString()),a.append("status",r.status),a.append("githubUrl",((t=r.githubUrl)==null?void 0:t.trim())||""),a.append("liveUrl",((s=r.liveUrl)==null?void 0:s.trim())||""),j&&a.append("thumbnail",j),h)for(let l=0;l<h.length;l++)a.append("screenshots",h[l]);console.log("Sending request to update project with data:",{id:r._id,title:r.title,hasThumbnail:!!j,screenshotCount:(h==null?void 0:h.length)||0});const f=await b.updateProjectWithImage(r._id,m,a);console.log("Project updated successfully:",f),x(p.map(l=>l._id===r._id?f.project:l)),g(null),N(null),C(null)}catch(a){console.error("Error updating project with image:",a),alert("Failed to update project: "+a.message)}finally{z(!1)}};c.useEffect(()=>{(async()=>{try{const s=await b.getAllProjects(m);x(s.projects||[])}catch(s){console.error("Error fetching projects:",s)}finally{$(!1)}})()},[m]),c.useEffect(()=>{if(!v)F(p);else{const t=v.toLowerCase();F(p.filter(s=>s.title.toLowerCase().includes(t)||s.description.toLowerCase().includes(t)||s.tags.some(a=>a.toLowerCase().includes(t))))}},[v,p]);const Z=async t=>{S(t),w(!0)},ee=async()=>{if(!(!P||!m))try{await b.deleteProject(P,m),x(p.filter(t=>t._id!==P))}catch(t){console.error("Error deleting project:",t)}finally{w(!1),S(null)}},te=async t=>{const s=p.find(a=>a._id===t);if(s)try{const a={...s,featured:!s.featured},f=await b.updateProject(t,m,a);x(p.map(l=>l._id===t?f.project:l))}catch(a){console.error("Error toggling featured status:",a)}},se=async t=>{const s=p.find(a=>a._id===t);if(s)try{const a={...s,status:s.status==="published"?"draft":"published"},f=await b.updateProject(t,m,a);x(p.map(l=>l._id===t?f.project:l))}catch(a){console.error("Error toggling publish status:",a)}},re=t=>new Date(t).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"});return e.jsx("div",{className:"min-h-screen from-gray-900 to-gray-800 p-4 md:p-8",children:e.jsxs("div",{className:"max-w-6xl mx-auto",children:[e.jsx("header",{className:"mb-8",children:e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between gap-4",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-white",children:"Project Manager"}),e.jsx("p",{className:"text-muted-foreground",children:"Manage your projects and portfolio items"})]}),e.jsxs(q,{open:K,onOpenChange:y,children:[e.jsx(ie,{asChild:!0,children:e.jsxs(d,{className:"flex items-center gap-2",children:[e.jsx(ge,{className:"w-4 h-4"}),"New Project"]})}),e.jsxs(_,{className:"max-w-3xl max-h-[90vh] overflow-y-auto bg-gray-900 text-white border border-gray-700",children:[e.jsx(A,{children:e.jsx(O,{children:"Create New Project"})}),e.jsxs("div",{className:"grid gap-4 py-4",children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsx(n,{htmlFor:"title",children:"Title"}),e.jsx(o,{id:"title",value:i.title,onChange:t=>u({...i,title:t.target.value}),placeholder:"Enter project title",className:"bg-gray-800 border-none text-white placeholder-gray-400 focus-visible:ring-0 focus-visible:ring-offset-0 resize-none"})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(n,{htmlFor:"description",children:"Description"}),e.jsx(B,{id:"description",value:i.description,onChange:t=>u({...i,description:t.target.value}),placeholder:"Describe your project",rows:4,className:"bg-gray-800 border-none text-white placeholder-gray-400 focus-visible:ring-0 focus-visible:ring-offset-0 resize-none"})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(n,{htmlFor:"tags",children:"Tags (comma separated)"}),e.jsx(o,{id:"tags",value:i.tags,onChange:t=>u({...i,tags:t.target.value}),placeholder:"React, Node.js, MongoDB, etc.",className:"bg-gray-800 border-none text-white placeholder-gray-400 focus-visible:ring-0 focus-visible:ring-offset-0 resize-none"})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(n,{htmlFor:"languages",children:"Languages (comma separated)"}),e.jsx(o,{id:"languages",value:i.languages,onChange:t=>u({...i,languages:t.target.value}),placeholder:"JavaScript, TypeScript, Python, etc.",className:"bg-gray-800 border-none text-white placeholder-gray-400 focus-visible:ring-0 focus-visible:ring-offset-0 resize-none"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsx(n,{htmlFor:"githubUrl",children:"GitHub URL"}),e.jsx(o,{id:"githubUrl",type:"url",value:i.githubUrl,onChange:t=>u({...i,githubUrl:t.target.value}),placeholder:"https://github.com/username/repo",className:"bg-gray-800 border-none text-white placeholder-gray-400 focus-visible:ring-0 focus-visible:ring-offset-0 resize-none"})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(n,{htmlFor:"liveUrl",children:"Live URL"}),e.jsx(o,{id:"liveUrl",type:"url",value:i.liveUrl,onChange:t=>u({...i,liveUrl:t.target.value}),placeholder:"https://project-name.vercel.app",className:"bg-gray-800 border-none text-white placeholder-gray-400 focus-visible:ring-0 focus-visible:ring-offset-0 resize-none"})]})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(n,{htmlFor:"thumbnail",children:"Thumbnail"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(o,{id:"thumbnail",type:"url",value:i.thumbnail,onChange:t=>u({...i,thumbnail:t.target.value}),placeholder:"https://example.com/image.jpg",className:"bg-gray-800 border-none text-white placeholder-gray-400 focus-visible:ring-0 focus-visible:ring-offset-0 resize-none"}),e.jsx(d,{type:"button",variant:"outline",size:"sm",onClick:()=>{var t;return(t=document.getElementById("file-upload-project-create"))==null?void 0:t.click()},disabled:!1,className:"border-input text-foreground hover:bg-accent hover:text-accent-foreground",children:"Choose File"}),e.jsx(o,{id:"file-upload-project-create",type:"file",accept:"image/*",onChange:L,className:"hidden"})]}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Enter image URL or upload a file (JPG, PNG, GIF)"})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(n,{htmlFor:"screenshots",children:"Screenshots"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(o,{id:"screenshots",value:i.screenshots,onChange:t=>u({...i,screenshots:t.target.value}),placeholder:"Upload screenshots",className:"bg-gray-800 border-none text-white placeholder-gray-400 focus-visible:ring-0 focus-visible:ring-offset-0 resize-none",readOnly:!0}),e.jsx(d,{type:"button",variant:"outline",size:"sm",onClick:()=>{var t;return(t=document.getElementById("file-upload-screenshots-create"))==null?void 0:t.click()},disabled:!1,className:"border-input text-foreground hover:bg-accent hover:text-accent-foreground",children:"Choose Files"}),e.jsx(o,{id:"file-upload-screenshots-create",type:"file",accept:"image/*",multiple:!0,onChange:I,className:"hidden"})]}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Select multiple screenshot files (JPG, PNG, GIF)"})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(n,{children:"Status"}),e.jsxs("div",{className:"flex gap-4",children:[e.jsxs("label",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"radio",name:"status",checked:i.status==="draft",onChange:()=>u({...i,status:"draft"})}),"Draft"]}),e.jsxs("label",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"radio",name:"status",checked:i.status==="published",onChange:()=>u({...i,status:"published"})}),"Published"]})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",id:"featured",checked:i.featured,onChange:t=>u({...i,featured:t.target.checked})}),e.jsx(n,{htmlFor:"featured",children:"Featured Project"})]}),e.jsxs("div",{className:"flex justify-end gap-2 pt-4",children:[e.jsx(d,{variant:"outline",onClick:()=>y(!1),className:"border-input text-foreground hover:bg-accent hover:text-accent-foreground",children:"Cancel"}),e.jsx(d,{onClick:V,disabled:k,children:k?"Creating...":e.jsxs(e.Fragment,{children:[e.jsx(H,{className:"w-4 h-4 mr-2"}),"Create Project"]})})]})]})]})]})]})}),e.jsx("div",{className:"mb-6",children:e.jsxs("div",{className:"relative",children:[e.jsx(pe,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-muted-foreground w-4 h-4"}),e.jsx(o,{placeholder:"Search projects...",value:v,onChange:t=>W(t.target.value),className:"flex h-10 w-full rounded-md border border-input bg-white dark:bg-slate-800 text-gray-900 dark:text-white px-3 py-2 ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm pl-10"})]})}),Y?e.jsx("div",{className:"text-center py-8",children:e.jsx("p",{className:"text-muted-foreground",children:"Loading projects..."})}):D.length===0?e.jsx(R,{className:"glass border border-primary/30",children:e.jsx(M,{className:"py-12 text-center",children:e.jsx("p",{className:"text-muted-foreground",children:"No projects found"})})}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:D.map(t=>e.jsxs(R,{className:"glass border border-primary/30",children:[e.jsxs(oe,{children:[e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsx(ce,{className:"text-xl",children:t.title}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(U,{variant:t.status==="published"?"default":"secondary",children:t.status}),t.featured&&e.jsxs(U,{variant:"outline",className:"bg-yellow-500/20 text-yellow-400 border-yellow-500",children:[e.jsx(J,{className:"w-3 h-3 mr-1"}),"Featured"]})]})]}),e.jsx(de,{children:re(t.createdAt)})]}),e.jsxs(M,{children:[e.jsx("p",{className:"text-muted-foreground mb-4 line-clamp-3",children:t.description}),e.jsx("div",{className:"flex flex-wrap gap-2 mb-4",children:t.tags.map((s,a)=>e.jsx(U,{variant:"outline",children:s},a))}),e.jsxs("div",{className:"flex gap-2 mb-4",children:[t.githubUrl&&e.jsx(d,{variant:"outline",size:"sm",asChild:!0,children:e.jsxs("a",{href:t.githubUrl,target:"_blank",rel:"noopener noreferrer",children:[e.jsx(le,{className:"w-4 h-4 mr-2"}),"Code"]})}),t.liveUrl&&e.jsx(d,{variant:"outline",size:"sm",asChild:!0,children:e.jsxs("a",{href:t.liveUrl,target:"_blank",rel:"noopener noreferrer",children:[e.jsx(ne,{className:"w-4 h-4 mr-2"}),"Live"]})})]}),e.jsxs("div",{className:"flex flex-wrap gap-2",children:[e.jsxs(d,{variant:"outline",size:"sm",onClick:()=>g(t),children:[e.jsx(ue,{className:"w-4 h-4 mr-2"}),"Edit"]}),e.jsxs(d,{variant:"outline",size:"sm",onClick:()=>te(t._id),className:t.featured?"text-yellow-500 border-yellow-500 bg-yellow-500/10":"text-muted-foreground",children:[e.jsx(J,{className:"w-4 h-4 mr-2"}),t.featured?"Featured":"Feature"]}),e.jsx(d,{variant:"outline",size:"sm",onClick:()=>se(t._id),children:t.status==="published"?"Unpublish":"Publish"}),e.jsxs(d,{variant:"outline",size:"sm",onClick:()=>Z(t._id),className:"text-red-500 border-red-500 hover:bg-red-500/10",children:[e.jsx(he,{className:"w-4 h-4 mr-2"}),"Delete"]})]})]})]},t._id))}),r&&e.jsx(q,{open:!!r,onOpenChange:t=>!t&&g(null),children:e.jsxs(_,{className:"max-w-3xl max-h-[90vh] overflow-y-auto bg-gray-900 text-white border border-gray-700",children:[e.jsx(A,{children:e.jsx(O,{children:"Edit Project"})}),e.jsxs("div",{className:"grid gap-4 py-4",children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsx(n,{htmlFor:"edit-title",children:"Title"}),e.jsx(o,{id:"edit-title",value:r.title,onChange:t=>g({...r,title:t.target.value}),placeholder:"Enter project title",className:"bg-gray-800 border-none text-white placeholder-gray-400 focus-visible:ring-0 focus-visible:ring-offset-0 resize-none"})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(n,{htmlFor:"edit-description",children:"Description"}),e.jsx(B,{id:"edit-description",value:r.description,onChange:t=>g({...r,description:t.target.value}),placeholder:"Describe your project",rows:4,className:"bg-gray-800 border-none text-white placeholder-gray-400 focus-visible:ring-0 focus-visible:ring-offset-0 resize-none"})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(n,{htmlFor:"edit-tags",children:"Tags (comma separated)"}),e.jsx(o,{id:"edit-tags",value:r.tags.join(", "),onChange:t=>g({...r,tags:t.target.value.split(",").map(s=>s.trim())}),placeholder:"React, Node.js, MongoDB, etc.",className:"bg-gray-800 border-none text-white placeholder-gray-400 focus-visible:ring-0 focus-visible:ring-offset-0 resize-none"})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(n,{htmlFor:"edit-languages",children:"Languages (comma separated)"}),e.jsx(o,{id:"edit-languages",value:r.languages.join(", "),onChange:t=>g({...r,languages:t.target.value.split(",").map(s=>s.trim())}),placeholder:"JavaScript, TypeScript, Python, etc.",className:"bg-gray-800 border-none text-white placeholder-gray-400 focus-visible:ring-0 focus-visible:ring-offset-0 resize-none"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsx(n,{htmlFor:"edit-githubUrl",children:"GitHub URL"}),e.jsx(o,{id:"edit-githubUrl",type:"url",value:r.githubUrl||"",onChange:t=>g({...r,githubUrl:t.target.value}),placeholder:"https://github.com/username/repo",className:"bg-gray-800 border-none text-white placeholder-gray-400 focus-visible:ring-0 focus-visible:ring-offset-0 resize-none"})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(n,{htmlFor:"edit-liveUrl",children:"Live URL"}),e.jsx(o,{id:"edit-liveUrl",type:"url",value:r.liveUrl||"",onChange:t=>g({...r,liveUrl:t.target.value}),placeholder:"https://project-name.vercel.app",className:"bg-gray-800 border-none text-white placeholder-gray-400 focus-visible:ring-0 focus-visible:ring-offset-0 resize-none"})]})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(n,{htmlFor:"edit-thumbnail",children:"Thumbnail"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(o,{id:"edit-thumbnail",type:"url",value:r.thumbnail||"",onChange:t=>g({...r,thumbnail:t.target.value}),placeholder:"https://example.com/image.jpg",className:"bg-gray-800 border-none text-white placeholder-gray-400 focus-visible:ring-0 focus-visible:ring-offset-0 resize-none"}),e.jsx(d,{type:"button",variant:"outline",size:"sm",onClick:()=>{var t;return(t=document.getElementById("file-upload-project-edit"))==null?void 0:t.click()},className:"border-input text-foreground hover:bg-accent hover:text-accent-foreground",children:"Choose File"}),e.jsx(o,{id:"file-upload-project-edit",type:"file",accept:"image/*",onChange:L,className:"hidden"})]}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Enter image URL or upload a file (JPG, PNG, GIF)"})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(n,{htmlFor:"edit-screenshots",children:"Screenshots"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(o,{id:"edit-screenshots",value:(G=r.screenshots)!=null&&G.length?`${r.screenshots.length} files selected`:"",placeholder:"Upload screenshots",className:"bg-gray-800 border-none text-white placeholder-gray-400 focus-visible:ring-0 focus-visible:ring-offset-0 resize-none",readOnly:!0}),e.jsx(d,{type:"button",variant:"outline",size:"sm",onClick:()=>{var t;return(t=document.getElementById("file-upload-screenshots-edit"))==null?void 0:t.click()},className:"border-input text-foreground hover:bg-accent hover:text-accent-foreground",children:"Choose Files"}),e.jsx(o,{id:"file-upload-screenshots-edit",type:"file",accept:"image/*",multiple:!0,onChange:I,className:"hidden"})]}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Select multiple screenshot files (JPG, PNG, GIF)"})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(n,{children:"Status"}),e.jsxs("div",{className:"flex gap-4",children:[e.jsxs("label",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"radio",name:"edit-status",checked:r.status==="draft",onChange:()=>g({...r,status:"draft"})}),"Draft"]}),e.jsxs("label",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"radio",name:"edit-status",checked:r.status==="published",onChange:()=>g({...r,status:"published"})}),"Published"]})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",id:"edit-featured",checked:r.featured,onChange:t=>g({...r,featured:t.target.checked})}),e.jsx(n,{htmlFor:"edit-featured",children:"Featured Project"})]}),e.jsxs("div",{className:"flex justify-end gap-2 pt-4",children:[e.jsx(d,{variant:"outline",onClick:()=>g(null),className:"border-input text-foreground hover:bg-accent hover:text-accent-foreground",children:"Cancel"}),e.jsx(d,{onClick:X,disabled:E,children:E?"Saving...":e.jsxs(e.Fragment,{children:[e.jsx(H,{className:"w-4 h-4 mr-2"}),"Save Changes"]})})]})]})]})}),e.jsx(me,{isOpen:Q,onClose:()=>{w(!1),S(null)},onConfirm:ee,title:"Delete Project",message:"Are you sure you want to delete this project? This action cannot be undone.",confirmText:"Delete",cancelText:"Cancel",variant:"destructive"})]})})};export{we as default};
