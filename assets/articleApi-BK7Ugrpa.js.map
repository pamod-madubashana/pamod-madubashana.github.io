{"version":3,"file":"articleApi-BK7Ugrpa.js","sources":["../../src/api/articleApi.ts"],"sourcesContent":["export interface Article {\n  _id: string;\n  title: string;\n  slug: string;\n  content: string;\n  excerpt: string;\n  status: 'draft' | 'published';\n  tags: string[];\n  featuredImage?: string;\n  author?: {\n    username: string;\n  } | null;\n  createdAt: string;\n  updatedAt: string;\n}\n\nexport interface CreateArticleData {\n  title: string;\n  content: string;\n  excerpt?: string;\n  status: 'draft' | 'published';\n  tags: string[];\n  featuredImage?: string;\n}\n\nexport interface UpdateArticleData {\n  title?: string;\n  content?: string;\n  excerpt?: string;\n  status?: 'draft' | 'published';\n  tags?: string[];\n  featuredImage?: string;\n}\n\nimport { API_BASE_URL } from '../lib/apiConfig';\nimport { apiCache, cacheKeys } from '../lib/cache';\n\nexport const articleApi = {\n  getPublishedArticles: async (): Promise<{ articles: Article[] }> => {\n    const cacheKey = cacheKeys.articles.published();\n    const cachedData = apiCache.get<{ articles: Article[] }>(cacheKey);\n    \n    if (cachedData) {\n      return cachedData;\n    }\n    \n    const response = await fetch(`${API_BASE_URL}/articles`);\n    if (!response.ok) {\n      const errorText = await response.text();\n      throw new Error(`Failed to fetch published articles: ${response.status} - ${errorText}`);\n    }\n    \n    const data = await response.json();\n    apiCache.set(cacheKey, data);\n    \n    return data;\n  },\n\n  getAllArticles: async (token: string): Promise<{ articles: Article[] }> => {\n    const cacheKey = cacheKeys.articles.all();\n    const cachedData = apiCache.get<{ articles: Article[] }>(cacheKey);\n    \n    if (cachedData) {\n      return cachedData;\n    }\n    \n    const response = await fetch(`${API_BASE_URL}/articles/all`, {\n      headers: {\n        'Authorization': `Bearer ${token}`\n      }\n    });\n    if (!response.ok) {\n      const errorText = await response.text();\n      throw new Error(`Failed to fetch all articles: ${response.status} - ${errorText}`);\n    }\n    \n    const data = await response.json();\n    apiCache.set(cacheKey, data);\n    \n    return data;\n  },\n\n  getArticleById: async (id: string): Promise<Article> => {\n    const cacheKey = cacheKeys.articles.byId(id);\n    const cachedData = apiCache.get<Article>(cacheKey);\n    \n    if (cachedData) {\n      return cachedData;\n    }\n    \n    const response = await fetch(`${API_BASE_URL}/articles/${id}`);\n    if (!response.ok) {\n      const errorText = await response.text();\n      throw new Error(`Failed to fetch article: ${response.status} - ${errorText}`);\n    }\n    \n    const data = await response.json();\n    apiCache.set(cacheKey, data);\n    \n    return data;\n  },\n\n  createArticle: async (token: string, articleData: CreateArticleData): Promise<{ message: string; article: Article }> => {\n    const response = await fetch(`${API_BASE_URL}/articles`, {\n      method: 'POST',\n      headers: {\n        'Content-Type': 'application/json',\n        'Authorization': `Bearer ${token}`\n      },\n      body: JSON.stringify(articleData)\n    });\n    if (!response.ok) {\n      const errorText = await response.text();\n      throw new Error(`Failed to create article: ${response.status} - ${errorText}`);\n    }\n    \n    const result = await response.json();\n    \n    // Invalidate cache after creating an article\n    apiCache.invalidate('articles:*');\n    \n    return result;\n  },\n\n  createArticleWithImage: async (\n    token: string,\n    formData: FormData\n  ): Promise<{ message: string; article: Article }> => {\n    const response = await fetch(`${API_BASE_URL}/articles/upload`, {\n      method: 'POST',\n      headers: {\n        'Authorization': `Bearer ${token}`\n      },\n      body: formData\n    });\n    if (!response.ok) {\n      const errorText = await response.text();\n      throw new Error(`Failed to create article with image: ${response.status} - ${errorText}`);\n    }\n    \n    const result = await response.json();\n    \n    // Invalidate cache after creating an article\n    apiCache.invalidate('articles:*');\n    \n    return result;\n  },\n\n  updateArticle: async (token: string, id: string, articleData: UpdateArticleData): Promise<{ message: string; article: Article }> => {\n    const response = await fetch(`${API_BASE_URL}/articles/${id}`, {\n      method: 'PUT',\n      headers: {\n        'Content-Type': 'application/json',\n        'Authorization': `Bearer ${token}`\n      },\n      body: JSON.stringify(articleData)\n    });\n    if (!response.ok) {\n      const errorText = await response.text();\n      throw new Error(`Failed to update article: ${response.status} - ${errorText}`);\n    }\n    \n    const result = await response.json();\n    \n    // Invalidate cache after updating an article\n    apiCache.delete(cacheKeys.articles.byId(id));\n    apiCache.invalidate('articles:*');\n    \n    return result;\n  },\n\n  updateArticleWithImage: async (\n    token: string,\n    id: string,\n    formData: FormData\n  ): Promise<{ message: string; article: Article }> => {\n    const response = await fetch(`${API_BASE_URL}/articles/upload/${id}`, {\n      method: 'PUT',\n      headers: {\n        'Authorization': `Bearer ${token}`\n      },\n      body: formData\n    });\n    if (!response.ok) {\n      const errorText = await response.text();\n      throw new Error(`Failed to update article with image: ${response.status} - ${errorText}`);\n    }\n    \n    const result = await response.json();\n    \n    // Invalidate cache after updating an article\n    apiCache.delete(cacheKeys.articles.byId(id));\n    apiCache.invalidate('articles:*');\n    \n    return result;\n  },\n\n  deleteArticle: async (token: string, id: string): Promise<{ message: string }> => {\n    const response = await fetch(`${API_BASE_URL}/articles/${id}`, {\n      method: 'DELETE',\n      headers: {\n        'Authorization': `Bearer ${token}`\n      }\n    });\n    if (!response.ok) {\n      const errorText = await response.text();\n      throw new Error(`Failed to delete article: ${response.status} - ${errorText}`);\n    }\n    \n    const result = await response.json();\n    \n    // Invalidate cache after deleting an article\n    apiCache.delete(cacheKeys.articles.byId(id));\n    apiCache.invalidate('articles:*');\n    \n    return result;\n  }\n};"],"names":["articleApi","cacheKey","cacheKeys","cachedData","apiCache","response","API_BASE_URL","errorText","data","token","id","articleData","result","formData"],"mappings":"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"}