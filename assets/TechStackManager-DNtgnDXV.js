import{a as g,j as e}from"./ui-DPnNW4ni.js";import{C as E,b as F,a as J,c as q,d as G}from"./card-CR5Xrna1.js";import{A as k,r as p,s as A,t as Q,i as V,v as W,B as x,j as X,w as Y,k as Z,I as C,z as ee}from"./index-DVbhnIum.js";import{L as y}from"./label-Ce0QUD1D.js";import{r as te,a as se,b as ae}from"./orderUtils-CV0GkM7y.js";import{P as re,S as ie,T as oe,C as le}from"./ConfirmDialog-BoJyXgSl.js";import{S as ce}from"./save-Dn31eVBV.js";import{S as ne}from"./search-DQ514EIm.js";import{C as de,S as he}from"./server-G5bDq408.js";import{C as ge}from"./cloud-DZAGxpzk.js";import{D as ue}from"./database-Bqovb1YH.js";const N=()=>{p.invalidate("techstack:*"),p.invalidate("about:*"),p.invalidate("dashboard:*")},b={getPublicCategories:async(r=!1)=>{const l=A.techStack.public();if(!r){const n=p.get(l);if(n)return n}const i=await fetch(`${k}/tech-stack-categories/public`);if(!i.ok){const n=await i.text();throw new Error(`Failed to fetch public tech stack categories: ${i.status} - ${n}`)}const o=await i.json();return p.set(l,o),o},getAllCategories:async(r,l=!1)=>{const i=A.techStack.all();if(!l){const h=p.get(i);if(h)return h}const o=await fetch(`${k}/tech-stack-categories`,{headers:{Authorization:`Bearer ${r}`}});if(!o.ok){const h=await o.text();throw new Error(`Failed to fetch tech stack categories: ${o.status} - ${h}`)}const n=await o.json();return p.set(i,n),n},createCategory:async(r,l)=>{const i=await fetch(`${k}/tech-stack-categories`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${r}`},body:JSON.stringify(l)});if(!i.ok){const n=await i.text();throw new Error(`Failed to create tech stack category: ${i.status} - ${n}`)}const o=await i.json();return N(),o},updateCategory:async(r,l,i)=>{const o=await fetch(`${k}/tech-stack-categories/${l}`,{method:"PUT",headers:{"Content-Type":"application/json",Authorization:`Bearer ${r}`},body:JSON.stringify(i)});if(!o.ok){const h=await o.text();throw new Error(`Failed to update tech stack category: ${o.status} - ${h}`)}const n=await o.json();return N(),n},deleteCategory:async(r,l)=>{const i=await fetch(`${k}/tech-stack-categories/${l}`,{method:"DELETE",headers:{Authorization:`Bearer ${r}`}});if(!i.ok){const o=await i.text();throw new Error(`Failed to delete tech stack category: ${i.status} - ${o}`)}N()}},Ne=()=>{const{token:r}=Q(),[l,i]=g.useState([]),[o,n]=g.useState([]),[h,I]=g.useState(""),[O,S]=g.useState(!0),[z,v]=g.useState(!1),[s,u]=g.useState(null),[c,f]=g.useState({title:"",icon:"Cpu",skills:[""],order:0}),[D,T]=g.useState({isOpen:!1,id:"",type:""}),j=async(t=!1)=>{if(!r){S(!1);return}try{const a=await b.getAllCategories(r,t);i(a)}catch(a){console.error("Error fetching tech stack categories:",a)}finally{S(!1)}};g.useEffect(()=>{j()},[r]),g.useEffect(()=>{if(!h)n(l);else{const t=h.toLowerCase();n(l.filter(a=>a.title.toLowerCase().includes(t)||a.skills.some(d=>d.toLowerCase().includes(t))))}},[h,l]);const L=async()=>{if(r)try{await se(l,c.order,"/tech-stack-categories",r),await b.createCategory(r,{...c,skills:c.skills.filter(t=>t.trim()!=="")}),await j(!0),f({title:"",icon:"Cpu",skills:[""],order:0}),v(!1)}catch(t){console.error("Error creating tech stack category:",t)}},B=async()=>{if(!(!s||!r))try{await te(l,s._id,s.order,"/tech-stack-categories",r),await b.updateCategory(r,s._id,{title:s.title,icon:s.icon,skills:s.skills.filter(t=>t.trim()!==""),order:s.order}),await j(!0),u(null)}catch(t){console.error("Error updating tech stack category:",t)}},_=async t=>{if(r)try{const a=l.find(d=>d._id===t);if(!a)return;await ae(l,a.order,"/tech-stack-categories",r),await b.deleteCategory(r,t),await j(!0)}catch(a){console.error("Error deleting tech stack category:",a)}},P=(t,a)=>{T({isOpen:!0,id:t,type:a})},$=()=>{T({isOpen:!1,id:"",type:""})},U=()=>{_(D.id),$()},K=t=>{switch(t.toLowerCase()){case"code":case"frontend":return ee;case"server":case"backend":return he;case"database":return ue;case"cloud":case"devops":return ge;default:return de}},M=t=>{t&&s?u({...s,skills:[...s.skills,""]}):f({...c,skills:[...c.skills,""]})},R=(t,a,d)=>{if(d&&s){const m=[...s.skills];m[t]=a,u({...s,skills:m})}else{const m=[...c.skills];m[t]=a,f({...c,skills:m})}},H=(t,a)=>{if(a&&s){const d=s.skills.filter((m,w)=>w!==t);u({...s,skills:d})}else{const d=c.skills.filter((m,w)=>w!==t);f({...c,skills:d})}};return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"min-h-screen from-gray-900 to-gray-800 p-4 md:p-8",children:e.jsxs("div",{className:"max-w-6xl mx-auto",children:[e.jsx("header",{className:"mb-8",children:e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between gap-4",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-white",children:"Tech Stack Categories Manager"}),e.jsx("p",{className:"text-muted-foreground",children:"Manage your technology stack categories and skills"})]}),e.jsxs(V,{open:z,onOpenChange:v,children:[e.jsx(W,{asChild:!0,children:e.jsxs(x,{className:"flex items-center gap-2",children:[e.jsx(re,{className:"w-4 h-4"}),"New Category"]})}),e.jsxs(X,{className:"max-w-3xl max-h-[90vh] overflow-y-auto bg-gray-900 text-white border border-gray-700",children:[e.jsx(Y,{children:e.jsx(Z,{children:s?"Edit Category":"Add New Category"})}),e.jsxs("div",{className:"grid gap-4 py-4",children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsx(y,{htmlFor:"title",children:"Category Title"}),e.jsx(C,{id:"title",value:s?s.title:c.title,onChange:t=>s?u({...s,title:t.target.value}):f({...c,title:t.target.value}),placeholder:"e.g., Frontend, Backend, Database",className:"bg-gray-800 border-none text-white placeholder-gray-400 focus-visible:ring-0 focus-visible:ring-offset-0 resize-none"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsx(y,{htmlFor:"icon",children:"Icon"}),e.jsxs("select",{id:"icon",value:s?s.icon:c.icon,onChange:t=>s?u({...s,icon:t.target.value}):f({...c,icon:t.target.value}),className:"w-full rounded-md border border-gray-700 bg-gray-800 px-3 py-2 text-white focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-blue-500",children:[e.jsx("option",{value:"Code",children:"Code (Frontend)"}),e.jsx("option",{value:"Server",children:"Server (Backend)"}),e.jsx("option",{value:"Database",children:"Database"}),e.jsx("option",{value:"Cloud",children:"Cloud (DevOps)"}),e.jsx("option",{value:"Cpu",children:"CPU (General)"})]})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(y,{htmlFor:"order",children:"Order"}),e.jsx(C,{id:"order",type:"number",value:s?s.order:c.order,onChange:t=>s?u({...s,order:parseInt(t.target.value)}):f({...c,order:parseInt(t.target.value)}),placeholder:"Order position",className:"bg-gray-800 border-none text-white placeholder-gray-400 focus-visible:ring-0 focus-visible:ring-offset-0 resize-none"})]})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx(y,{children:"Skills"}),e.jsx(x,{type:"button",variant:"outline",size:"sm",onClick:()=>M(!!s),className:"border-input text-foreground hover:bg-accent hover:text-accent-foreground",children:"Add Skill"})]}),e.jsx("div",{className:"space-y-2",children:(s?s.skills:c.skills).map((t,a)=>e.jsxs("div",{className:"flex gap-2",children:[e.jsx(C,{value:t,onChange:d=>R(a,d.target.value,!!s),placeholder:`Skill ${a+1}`,className:"bg-gray-800 border-none text-white placeholder-gray-400 focus-visible:ring-0 focus-visible:ring-offset-0 resize-none"}),(s?s.skills:c.skills).length>1&&e.jsx(x,{type:"button",variant:"outline",size:"sm",onClick:()=>H(a,!!s),className:"border-input text-foreground hover:bg-accent hover:text-accent-foreground",children:"Remove"})]},a))})]}),e.jsxs("div",{className:"flex justify-end gap-2 pt-4",children:[e.jsx(x,{variant:"outline",onClick:()=>{v(!1),u(null)},className:"border-input text-foreground hover:bg-accent hover:text-accent-foreground",children:"Cancel"}),e.jsxs(x,{onClick:s?B:L,children:[e.jsx(ce,{className:"w-4 h-4 mr-2"}),s?"Update":"Add"]})]})]})]})]})]})}),e.jsx("div",{className:"mb-6",children:e.jsxs("div",{className:"relative",children:[e.jsx(ne,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-muted-foreground w-4 h-4"}),e.jsx(C,{placeholder:"Search tech stack categories...",value:h,onChange:t=>I(t.target.value),className:"flex h-10 w-full rounded-md border border-input bg-white dark:bg-slate-800 text-gray-900 dark:text-white px-3 py-2 ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm pl-10"})]})}),O?e.jsx("div",{className:"text-center py-8",children:e.jsx("p",{className:"text-muted-foreground",children:"Loading tech stack categories..."})}):o.length===0?e.jsx(E,{className:"glass border border-primary/30",children:e.jsx(F,{className:"py-12 text-center",children:e.jsx("p",{className:"text-muted-foreground",children:"No tech stack categories found"})})}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:o.map(t=>{const a=K(t.icon);return e.jsxs(E,{className:"glass border border-primary/30 relative",children:[e.jsx("div",{className:"absolute -top-2 -left-2 bg-primary text-white rounded-full w-6 h-6 flex items-center justify-center text-xs font-bold z-10",children:t.order}),e.jsx(J,{children:e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{children:[e.jsxs(q,{className:"flex items-center gap-2",children:[e.jsx(a,{className:"w-5 h-5 text-primary"}),t.title]}),e.jsxs(G,{className:"mt-1",children:["Skills: ",t.skills.length]})]}),e.jsxs("div",{className:"flex gap-1",children:[e.jsx(x,{size:"sm",variant:"ghost",onClick:()=>{u(t),v(!0)},className:"h-8 w-8 p-0",children:e.jsx(ie,{className:"w-4 h-4"})}),e.jsx(x,{size:"sm",variant:"ghost",onClick:()=>P(t._id,"delete"),className:"h-8 w-8 p-0 text-red-500 hover:text-red-500",children:e.jsx(oe,{className:"w-4 h-4"})})]})]})}),e.jsx(F,{children:e.jsx("div",{className:"space-y-1",children:t.skills.map((d,m)=>e.jsxs("div",{className:"text-sm text-muted-foreground",children:["â€¢ ",d]},m))})})]},t._id)})})]})}),e.jsx(le,{isOpen:D.isOpen,onClose:$,onConfirm:U,title:"Confirm Deletion",message:"Are you sure you want to delete this tech stack category? This action cannot be undone.",confirmText:"Delete",cancelText:"Cancel",variant:"destructive"})]})};export{Ne as default};
